name: Discord notification

on:
  push:
    branches:
      - main

jobs: 
  discord_notification: 
    runs-on: ubuntu-20.04
    steps:
      - uses: actions/checkout@v4
      - name: Notification
        uses: rjstone/discord-webhook-notify@v1
        if: ${{ success() }}
        with:
            severity: info
            description: to https://full-stack-open-pokedex-icy-smoke-5647.fly.dev/ by ${{ github.repository_owner }}
            text: A new version of Pokedex deployed
            webhookUrl: ${{ secrets.DISCORD_WEBHOOK }}

      - uses: actions/checkout@v4
      - name: Test Error
        uses: rjstone/discord-webhook-notify@v1
        if: ${{ failure() }}
        with:
            severity: error
            text: Build failed
            webhookUrl: ${{ secrets.DISCORD_WEBHOOK }}

      
